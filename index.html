<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TimberTally</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>

    <!-- === Main Data Entry View === -->
    <div id="entryView">
        <h1>TimberTally</h1>

        <div class="input-section">
            <!-- Plot Number Counter Section -->
            <div class="plot-number-section">
                <label for="plotNumberDisplay" class="plot-number-label">Plot #:</label>
                <div class="plot-counter-group">
                    <button type="button" id="plotDecrementBtn" class="plot-counter-btn" title="Decrement Plot Number">-</button>
                    <span id="plotNumberDisplay" title="Current Plot Number">1</span>
                    <button type="button" id="plotIncrementBtn" class="plot-counter-btn" title="Increment Plot Number">+</button>
                </div>
            </div>
            <!-- Species -->
            <div class="input-group">
                <label for="speciesSelect">Species:</label>
                <select id="speciesSelect">
                    <!-- Options populated by JavaScript -->
                </select>
            </div>
            <!-- DBH -->
            <div class="input-group">
                <label for="dbhSelect">DBH:</label>
                <select id="dbhSelect"></select>
            </div>
            <!-- Logs -->
            <div class="input-group">
                <label for="logsSelect">Logs:</label>
                <select id="logsSelect"></select>
            </div>
             <!-- Condensed Row -->
            <div class="input-row-condensed">
                <div class="cut-checkbox-group">
                    <input type="checkbox" id="cutCheckbox" name="cutStatus">
                    <label for="cutCheckbox">Cut</label>
                </div>
                <div class="location-group">
                    <button type="button" id="getLocationBtn" title="Get GPS Location">Get Location</button>
                    <span id="locationStatus" title="GPS Status">Location not set</span>
                </div>
            </div>
            <!-- Notes Textarea -->
            <div class="input-group">
                <label for="notesTextarea">Notes:</label>
                <textarea id="notesTextarea" rows="2"></textarea>
            </div>
        </div>

        <div class="button-section">
            <button id="submitBtn">Submit Entry</button>
            <button id="saveCsvBtn" disabled>Save CSV File</button>
            <button id="viewTallyBtn" disabled>View Tally</button>
        </div>

        <!-- Feedback Message Area -->
        <div id="feedbackMsg" class="feedback-message"></div>

        <!-- === Recent Entries Table === -->
        <div class="output-section">
            <h2>Recent Entries (<span id="entryCount">0</span>)</h2>
            <div class="delete-button-container">
                <button id="deleteBtn" class="delete-button" disabled>Delete Selected</button>
            </div>
            <div class="table-container"> <!-- Added container for scrolling -->
                <table id="entriesTable">
                    <thead>
                        <tr>
                            <th><!-- Checkbox --></th>
                            <th>Plot</th>
                            <th>Species</th>
                            <th>DBH</th>
                            <th>Logs</th>
                            <th>Cut</th>
                        </tr>
                    </thead>
                    <tbody id="entriesTableBody">
                        <!-- Data rows will be inserted here by JS -->
                        <tr id="noEntriesRow">
                             <td colspan="6">No data submitted yet.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- === END Recent Entries Table === -->


        <!-- === Collapsible Species Management Section Trigger === -->
        <div class="toggle-section">
            <button id="toggleSpeciesMgmtBtn" class="toggle-button" aria-expanded="false" aria-controls="speciesManagementSection">
                Show Species Management â–¼ <!-- Down arrow -->
            </button>
        </div>

        <!-- === Species Management Section (Initially Hidden) === -->
        <div id="speciesManagementSection" class="input-section collapsible-section" hidden> <!-- Start hidden -->
            <h2>Manage Species</h2>
            <div class="species-add-group">
                <label for="newSpeciesInput">Add New Species:</label>
                <div class="input-with-button">
                    <input type="text" id="newSpeciesInput" placeholder="Enter species name">
                    <button id="addSpeciesBtn" title="Add Species to List">+</button>
                </div>
            </div>
            <div class="species-remove-group">
                <label for="removeSpeciesSelect">Select Species to Remove:</label>
                <select id="removeSpeciesSelect" multiple size="6"></select>
                <button id="removeSpeciesBtn">Remove Selected</button>
            </div>
            <div id="speciesMgmtFeedback" class="feedback-message" style="margin-top: 10px;"></div>
        </div>
        <!-- === END Species Management Section === -->

        <!-- Delete All Button Section -->
        <div class="delete-all-section">
            <button id="deleteAllBtn" class="delete-all-button" disabled>Delete All Data</button>
        </div>

    </div> <!-- End of entryView -->

    <!-- === Tally View (Initially Hidden) === -->
    <div id="tallyView" style="display: none;">
        <h1>Data Tally</h1>
        <div class="tally-section">
             <h2>Tally by Species, DBH, Logs, Cut Status</h2> <!-- Updated Tally Title -->
             <div id="tallyResults">
                 <p>Calculating tally...</p>
             </div>
             <div class="button-section">
                <button id="backToEntryBtn">Back to Data Entry</button>
             </div>
        </div>
    </div> <!-- End of tallyView -->

    <!-- === Form Class Selection Modal (Initially Hidden) === -->
    <div id="fcPromptModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Select Doyle Form Class</h2>
            <p>Choose the Form Class to use for volume calculations in the report:</p>
            <div class="fc-options">
                <label><input type="radio" name="formClass" value="72" checked> FC 72</label>
                <label><input type="radio" name="formClass" value="74"> FC 74</label>
                <label><input type="radio" name="formClass" value="76"> FC 76</label>
                <label><input type="radio" name="formClass" value="78"> FC 78</label>
            </div>
            <div class="modal-buttons">
                <button id="confirmFcBtn">Confirm & Save CSV</button>
                <button id="cancelFcBtn" type="button">Cancel</button>
            </div>
        </div>
    </div>
    <!-- === END Form Class Selection Modal === -->

    <script src="script.js" defer></script>
</body>
</html>
